## polling和long polling的区别

当浏览器端与服务器建立连接之后，一般有两种方式可以获取到服务器的更新信息，即polling和long polling

polling 是轮询，是指浏览器通过周期性轮询，查看服务器是否有更新的信息；

long polling 是长轮询，浏览器与服务器建立连接之后，服务器将此连接进行挂起，但有更新信息时，再将信息发送给 浏览器端。浏览器端重新建立连接，如此循环反复，这是一种长连接的方式

一个比较形象的例子：

传统的polling一般是由C向S询问："有我的信件吗？"。S接到询问之后，会立即查询，并且把查询结果告诉 C，不管有没有C的信件，要么回复："嗯，你有X封信"。要么回复："没，没有你的信"

而Long Polling更像是这样，C向S发出询问："有我的信件吗"，S开始查询，如果有则回复C："嗯，有你X封信"。如果没有， 则不作任何回复，而是让C等着，自己一遍一遍地查询是否有订阅者的信。

换句话说：当S收到C的查询请求之后，Polling则只查询一次，并且把查询结果告诉C，而Long Polling收到 请求之后，则会一遍一遍地查询，直到有信息才会响应C，不然一直hold Client

#### 优缺点分析

**轮询（polling）**

轮询：客户端定时向服务器发送Ajax请求，服务器接受到请求后马上返回响应信息并关闭连接

优点：后端程序编写比较容易

缺点：请求中有大半是误用的，浪费带宽和服务器资源

实例：适于小型应用

**长轮询（long polling）**

长轮询：客户端向服务器发送Ajax请求，服务器接到请求或hold住连接，直到有新信息才返回响应信息并关闭连接，客户端处理完响应信息后再向服务器发送新的请求

优点：在无消息的情况下不会频繁的请求，耗费资源小

缺点：服务器hold连接会消耗资源，返回数据顺序无保证，难于管理维护

实例：WebQQ，Hi网页版，Facebook IM